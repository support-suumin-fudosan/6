<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æ—¥å ± å›ç­”ãƒ•ã‚©ãƒ¼ãƒ </title>
  <meta name="description" content="æ—¥å ±ã‚’å…¥åŠ›ã§ãã‚‹å›ç­”ãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚" />

  <style>
    :root{
      --bg: #f7faf8;
      --card: #ffffff;
      --text: #0f172a;
      --muted: #6b7280;
      --line: #e5e7eb;
      --accent: #1f9d63;
      --accent-2: #0f7a4a;
      --accent-soft: #e7f7ef;
      --danger: #dc2626;
      --shadow: 0 10px 28px rgba(2, 24, 12, 0.08);
      --radius-lg: 16px;
      --radius-md: 10px;
      --radius-sm: 8px;
    }

    *{ box-sizing: border-box; }

    html, body{
      width: 100%;
      max-width: 100%;
      overflow-x: hidden;
    }

    html, body{
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, "Hiragino Kaku Gothic ProN", "Noto Sans JP", "Segoe UI", sans-serif;
      color: var(--text);
      background:
        radial-gradient(1200px 500px at 85% -10%, var(--accent-soft), transparent 60%),
        radial-gradient(900px 500px at -10% 10%, #f0fbf5, transparent 55%),
        var(--bg);
    }

    .page{
      min-height: 100dvh;
      display: grid;
      grid-template-rows: auto 1fr auto;
      gap: 20px;
      overflow-x: hidden;
    }

    header{
      position: sticky;
      top: 0;
      z-index: 10;
      backdrop-filter: blur(10px);
      background: rgba(247, 250, 248, 0.8);
      border-bottom: 1px solid rgba(0,0,0,0.04);
    }

    .header-inner{
      max-width: 920px;
      margin: 0 auto;
      padding: 16px 18px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    .header-form{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      width: 100%;
      min-width: 0;
    }

    .header-thanks{
      display: none;
      width: 100%;
      justify-content: center;
      align-items: center;
    }
    .thanks-title{
      font-weight: 800;
      letter-spacing: 0.02em;
      font-size: 16.5px;
      color: #0f172a;
      padding: 6px 10px;
      border-radius: 999px;
      background: #ffffff;
      border: 1px solid rgba(31,157,99,0.18);
      box-shadow: 0 6px 14px rgba(2, 24, 12, 0.06);
    }

    .brand{
      display: flex;
      align-items: center;
      gap: 10px;
      font-weight: 700;
      letter-spacing: 0.02em;
      min-width: 0;
    }

    .brand-icon{
      width: 32px;
      height: 32px;
      border-radius: 10px;
      object-fit: cover;
      flex: 0 0 32px;
      background: linear-gradient(135deg, #e3f8f0, #f6fffb);
      box-shadow:
        0 2px 8px rgba(2, 24, 12, 0.12),
        inset 0 0 0 1px rgba(255,255,255,0.7);
      image-rendering: auto;
    }

    .brand-badge{
      width: 32px;
      height: 32px;
      border-radius: 10px;
      background: linear-gradient(135deg, #dff7ea, #f5fffb);
      border: 1px solid rgba(31,157,99,0.20);
      box-shadow: 0 2px 6px rgba(15,23,42,0.12);
      display: none;
    }

    .container{
      width: 100%;
      max-width: 920px;
      margin: 0 auto 24px;
      padding: 0 4vw;
    }
    @media (min-width: 920px){
      .container{ padding: 0 18px; }
    }

    .hero{
      background: linear-gradient(135deg, #ffffff, #ffffff 55%, var(--accent-soft));
      border: 1px solid var(--line);
      border-radius: var(--radius-lg);
      padding: 26px 22px 22px;
      box-shadow: var(--shadow);
      position: relative;
      overflow: hidden;
    }
    .hero::after{
      content: "";
      position: absolute;
      right: -120px;
      top: -140px;
      width: 320px;
      height: 320px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, rgba(31,157,99,0.18), transparent 65%);
      pointer-events: none;
    }

    .hero-head{
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .hero .meta{
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      background: var(--accent-soft);
      border: 1px solid rgba(31,157,99,0.18);
      border-radius: 999px;
      font-size: 12px;
      color: var(--accent-2);
      font-weight: 600;
      margin-left: -2px;
      transform: translateY(-2px);
      width: fit-content;
      max-width: 100%;
    }

    .hero h1{
      margin: 0 0 2px;
      font-size: clamp(24px, 3.6vw, 31px);
      letter-spacing: 0.01em;
    }

    form{
      margin-top: 18px;
      background: var(--card);
      border: 1px solid var(--line);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      padding: 10px 0 4px;
    }

    .section{
      padding: 18px 22px 6px;
      border-top: 1px dashed rgba(0,0,0,0.06);
    }
    .section:first-child{ border-top: none; }

    .section-title{
      display: flex;
      align-items: baseline;
      gap: 8px;
      margin: 0 0 12px;
      font-size: 15px;
      font-weight: 700;
      flex-wrap: wrap;
    }
    .section-title.big{
      font-size: 16.5px;
      letter-spacing: 0.01em;
    }

    .section-title .req{
      color: var(--danger);
      font-size: 12px;
      font-weight: 800;
    }
    .section-title .opt{
      color: var(--muted);
      font-size: 12px;
      font-weight: 800;
    }
    .section-title .opt-black{
      color: #111827;
      font-size: 12px;
      font-weight: 800;
    }

    .section-sub{
      margin: -6px 0 12px;
      font-size: 12px;
      color: var(--muted);
    }

    .note{
      font-size: 12px;
      color: var(--muted);
      margin-top: -2px;
      line-height: 1.5;
    }

    .field{
      display: grid;
      gap: 8px;
      margin-bottom: 14px;
      min-width: 0;
    }

    input[type="text"],
    input[type="date"],
    input[type="number"],
    textarea{
      width: 100%;
      border: 1px solid var(--line);
      border-radius: var(--radius-md);
      padding: 12px 12px;
      font-size: 16px;
      outline: none;
      background: #fff;
      transition: border .15s ease, box-shadow .15s ease, background .15s ease;
      max-width: 100%;
    }
    textarea{
      min-height: 110px;
      resize: vertical;
    }

    input::placeholder, textarea::placeholder{ color: #9aa3af; }

    input:focus, textarea:focus{
      border-color: rgba(31,157,99,0.55);
      box-shadow: 0 0 0 4px rgba(31,157,99,0.12);
      background: #fcfffd;
    }

    .hint{
      font-size: 11.5px;
      color: var(--muted);
    }

    .actions{
      padding: 18px 22px 22px;
      display: grid;
      gap: 10px;
    }

    .btn{
      border: none;
      border-radius: 14px;
      padding: 14px 14px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      transition: transform .08s ease, filter .15s ease, box-shadow .15s ease;
    }
    .btn-primary{
      background: linear-gradient(135deg, var(--accent), #39d489);
      color: white;
      box-shadow: 0 10px 18px rgba(31,157,99,0.22);
    }
    .btn-primary:hover{ filter: brightness(1.02); }
    .btn-primary:active{ transform: translateY(1px); }

    .btn-ghost{
      background: #fff;
      border: 1px solid var(--line);
      color: #111827;
    }

    .error{
      color: var(--danger);
      font-size: 11.5px;
      font-weight: 600;
      display: none;
    }

    .divider{
      height: 1px;
      background: rgba(0,0,0,0.04);
      margin: 10px 0 2px;
    }

    .kpi{
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 10px 12px;
      border-radius: 12px;
      background: linear-gradient(135deg, #ffffff, #ffffff 55%, var(--accent-soft));
      border: 1px solid rgba(31,157,99,0.18);
    }
    .kpi strong{
      font-size: 15px;
      letter-spacing: 0.01em;
    }
    .kpi .val{
      font-weight: 800;
      color: var(--accent-2);
    }

    /* å…±é€šï¼šä»²é–“ã§æ‹¬ã‚‹ã‚«ãƒ¼ãƒ‰ï¼ˆLINEçŠ¶æ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’è¸è¥²ï¼‰ */
    .group-card{
      border-radius: 14px;
      border: 1px solid rgba(31,157,99,0.18);
      background: linear-gradient(135deg, #ffffff, #ffffff 55%, var(--accent-soft));
      padding: 12px;
      display: grid;
      gap: 12px;
      box-shadow: 0 8px 16px rgba(2,24,12,0.05);
      min-width: 0;
    }
    .card-item{
      min-width: 0;
      display: grid;
      gap: 6px;
    }
    .card-label{
      display: flex;
      align-items: baseline;
      justify-content: flex-start;
      gap: 10px;
      margin: 0;
      font-weight: 800;
      letter-spacing: 0.01em;
      font-size: 15px;
      flex-wrap: wrap;
    }
    .group-card input[type="number"],
    .group-card input[type="text"],
    .group-card input[type="date"],
    .group-card textarea{
      border-radius: 12px;
      font-weight: 700;
      min-width: 0;
    }
    .group-card textarea{ font-weight: 600; }

    /* 2åˆ—/3åˆ—ã®ä»²é–“æ‹¬ã‚Šï¼ˆç¸¦ä»•åˆ‡ã‚Šã¯PCã®ã¿ï¼‰ */
    @media (min-width: 720px){
      .group-card.cols-2{
        grid-template-columns: 1fr 1fr;
        gap: 14px;
      }
      .group-card.cols-3{
        grid-template-columns: repeat(3, minmax(0, 1fr));
        gap: 14px;
      }
      .group-card.cols-2 .card-item:not(:first-child),
      .group-card.cols-3 .card-item:not(:first-child){
        border-left: 1px solid rgba(0,0,0,0.06);
        padding-left: 14px;
      }
    }

    /* æ—¥ä»˜ã®æ ï¼šæ¨ªé•·ãªä¸¸æ ï¼ˆå››è§’æ ã˜ã‚ƒãªãï¼‰ */
    .date-input{
      padding: 10px 14px;
      font-size: 14.5px;
      border-radius: 999px;
    }

    /* ===== åŸºæœ¬æƒ…å ±ï¼šç¸¦ç”»é¢ã§ã‚‚å´©ã‚Œãªã„ã‚ˆã†ã«å›ºå®šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ ===== */
    .basic-card{
      grid-template-columns: 1fr;
      grid-template-areas:
        "date"
        "name"
        "summary";
    }
    .basic-date{ grid-area: date; }
    .basic-name{ grid-area: name; }
    .basic-summary{ grid-area: summary; }

    /* ã‚¹ãƒãƒ›ã§è¦‹ãŸç›®ã‚’æ•´ãˆã‚‹ï¼ˆè©°ã¾ã‚Š/æ®µå·®ã®é˜²æ­¢ï¼‰ */
    .basic-card .card-item{
      padding: 0;
    }
    .basic-card .basic-date input[type="date"]{
      padding: 9px 12px;
      font-size: 13.5px;
      border-radius: 999px;
    }
    .basic-card .basic-summary textarea{
      min-height: 130px;
      font-weight: 600;
    }

    @media (min-width: 720px){
      .basic-card{
        grid-template-columns: 160px 1fr;
        grid-template-areas:
          "date name"
          "summary summary";
        gap: 14px;
        align-items: start;
      }
      /* PCæ™‚ã®ã¿ã€nameå´ã«ä»•åˆ‡ã‚Š */
      .basic-card .basic-name{
        border-left: 1px solid rgba(0,0,0,0.06);
        padding-left: 14px;
      }
      /* summaryã¯æ¨ªæ–­ãªã®ã§ä»•åˆ‡ã‚Šãªã— */
      .basic-card .basic-summary{
        border-left: none;
        padding-left: 0;
      }
    }

    /* å¥‘ç´„ï¼šé€²æ—ï¼ˆtextareaï¼‰ï¼‹é€²è¡Œä¸­åˆè¨ˆï¼ˆnumberï¼‰ã‚’åŒã˜ä»²é–“ */
    .contract-card{
      gap: 12px;
    }
    @media (min-width: 720px){
      .contract-card{
        grid-template-columns: 1fr 230px;
        gap: 14px;
        align-items: start;
      }
      .contract-card .card-item:not(:first-child){
        border-left: 1px solid rgba(0,0,0,0.06);
        padding-left: 14px;
      }
    }
    .contract-card textarea{ min-height: 150px; }

    /* æ¸©åº¦æ„Ÿï¼š3ã¤åŒã‚µã‚¤ã‚º */
    .temp-card textarea{ min-height: 150px; }
    .temp-chip{
      display: inline-flex;
      align-items: center;
      gap: 6px;
      width: fit-content;
      padding: 6px 10px;
      border-radius: 999px;
      background: #ffffff;
      border: 1px solid rgba(31,157,99,0.18);
      color: var(--accent-2);
      font-weight: 900;
      font-size: 12px;
      letter-spacing: 0.06em;
      box-shadow: 0 6px 14px rgba(2, 24, 12, 0.05);
    }
    .temp-chip[data-level="mid"]{ color: #0f7a4a; }
    .temp-chip[data-level="low"]{ color: #0f7a4a; opacity: 0.9; }

    /* æˆç´„çŠ¶æ³ï¼šç´¯è¨ˆ/ä»Šæœˆãã‚Œãã‚Œã€Œ3ã¤ã§ä¸€æ‹¬ã‚Šã€ */
    .conv-card{
      gap: 12px;
    }
    @media (min-width: 720px){
      .conv-card{
        grid-template-columns: 1fr 1fr 1fr;
        gap: 14px;
      }
      .conv-card .card-item:not(:first-child){
        border-left: 1px solid rgba(0,0,0,0.06);
        padding-left: 14px;
      }
    }
    .conv-card .kpi{
      height: 100%;
      min-height: 52px;
    }

    .spacer-xl{ height: 18px; }

    footer{
      padding: 10px 18px 26px;
      color: var(--muted);
      font-size: 11px;
      text-align: center;
    }

    .thankyou-stage{
      position: relative;
      min-height: 62vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding-top: 10px;
    }
    @media (max-height: 700px){
      .thankyou-stage{ min-height: 56vh; }
    }

    .thankyou{
      width: 100%;
      margin-top: 10px;
      background: linear-gradient(135deg, #ffffff, #ffffff 55%, var(--accent-soft));
      border: 1px solid var(--line);
      border-radius: var(--radius-lg);
      padding: 34px 22px 26px;
      box-shadow: var(--shadow);
      text-align: center;
    }

    @keyframes fadeInSoft {
      from { opacity: 0; transform: translateY(4px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    .fade-in{ animation: fadeInSoft 200ms ease-out; }

    .done-badge{
      width: 54px;
      height: 54px;
      border-radius: 50%;
      margin: 0 auto 10px;
      background: linear-gradient(135deg, #d6f5e3, #ecfbf3);
      border: 1px solid rgba(31,157,99,0.22);
      display: grid;
      place-items: center;
      box-shadow: 0 8px 16px rgba(2, 24, 12, 0.06);
    }
    .done-badge svg{ width: 26px; height: 26px; display: block; }

    .done-kicker{
      font-size: 11.5px;
      font-weight: 700;
      color: var(--accent-2);
      letter-spacing: 0.08em;
      margin-bottom: 2px;
    }

    .thankyou h2{
      margin: 0 0 12px;
      font-size: clamp(22px, 3.2vw, 26px);
      letter-spacing: 0.01em;
    }

    .thankyou-body{
      color: var(--muted);
      line-height: 1.7;
      font-size: 14.5px;
      margin: 0 0 14px;
    }

    .thankyou-secondary{
      font-size: 12.5px;
      color: #556070;
      font-weight: 600;
      margin: 0;
    }

    .thankyou-footnote{
      text-align: center;
      margin-top: 10px;
      font-size: 11px;
      color: var(--muted);
    }
  </style>

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
</head>

<body>
  <div class="page">
    <header>
      <div class="header-inner">
        <div class="header-form" id="headerForm">
          <div class="brand">
            <img
              class="brand-icon"
              src="YOUR_ICON_URL"
              alt="æ—¥å ±ãƒ•ã‚©ãƒ¼ãƒ "
              onerror="this.style.display='none'; this.nextElementSibling.style.display='inline-block';"
            />
            <span class="brand-badge" aria-hidden="true"></span>

            <div>
              <div>æ—¥å ± å›ç­”ãƒ•ã‚©ãƒ¼ãƒ </div>
            </div>
          </div>
        </div>

        <div class="header-thanks" id="headerThanks">
          <div class="thanks-title">é€ä¿¡å®Œäº†</div>
        </div>
      </div>
    </header>

    <main class="container">
      <section class="hero" id="heroSection">
        <div class="hero-head">
          <span class="meta">æ—¥å ±ã‚’è¨˜å…¥ã—ã¦ãã ã•ã„</span>
          <h1>ãŠç–²ã‚Œã•ã¾ã§ã™ğŸ˜–</h1>
        </div>
      </section>

      <div class="thankyou-stage" id="thankYouStage" style="display:none;">
        <div style="width:100%;">
          <section class="thankyou" id="thankYouSection">
            <div class="done-badge" aria-hidden="true">
              <svg viewBox="0 0 24 24" role="img" aria-label="å®Œäº†">
                <path fill="#ffffff" d="M9.0 16.2l-3.5-3.5a1 1 0 0 1 1.4-1.4l2.8 2.8 7.3-7.3a1 1 0 1 1 1.4 1.4l-8.0 8.0a1 1 0 0 1-1.4 0z"/>
              </svg>
            </div>

            <div class="done-kicker">é€ä¿¡å®Œäº†</div>

            <h2>æ—¥å ±ã€å—ã‘å–ã‚Šã¾ã—ãŸğŸ˜Œ</h2>

            <p class="thankyou-body">
              å…±æœ‰ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚<br>
              åæ˜ ãƒ»ç¢ºèªã—ã¾ã™ã€‚
            </p>

            <p class="thankyou-secondary">
              è¿½è¨˜ãŒã‚ã‚Œã°ã€åŒã˜ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰å†é€ã—ã¦OKã§ã™ã€‚
            </p>
          </section>

          <div class="thankyou-footnote">
            â€»ã“ã®ãƒ•ã‚©ãƒ¼ãƒ ã¯ EmailJS é€ä¿¡ã«å¯¾å¿œã—ã¦ã„ã¾ã™
          </div>
        </div>
      </div>

      <form id="dailyReportForm" novalidate>
        <!-- åŸºæœ¬æƒ…å ±ï¼ˆ3é …ç›®ã‚’ã²ã¨ã¾ã¨ã‚ / å¤§é …ç›®ã«å¿…é ˆï¼‰ -->
        <div class="section">
          <div class="section-title big">åŸºæœ¬æƒ…å ± <span class="req">å¿…é ˆ</span></div>

          <div class="field">
            <div class="group-card basic-card" role="group" aria-label="åŸºæœ¬æƒ…å ±">
              <div class="card-item basic-date">
                <div class="card-label">æ—¥ä»˜</div>
                <input id="date" name="date" type="date" class="date-input" required />
                <div class="error" data-error-for="date">æ—¥ä»˜ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>

              <div class="card-item basic-name">
                <div class="card-label">æ°å</div>
                <input id="name" name="name" type="text" required />
                <div class="error" data-error-for="name">æ°åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>

              <div class="card-item basic-summary">
                <div class="card-label">æœ¬æ—¥ã®æ¥­å‹™å†…å®¹</div>
                <textarea
                  id="summary"
                  name="summary"
                  placeholder="å†…è¦‹ï¼ˆæ’®å½±ï¼‰ã€å†…è¦‹ï¼ˆå–¶æ¥­ï¼‰ã€å‹•ç”»ç·¨é›†ã€è¦‹ç©ã‚‚ã‚Šä½œæˆã€è¿½å®¢ã€æ¶é›»ãªã©"
                  required
                ></textarea>
                <div class="error" data-error-for="summary">æœ¬æ—¥ã®æ¥­å‹™å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>
            </div>
          </div>
        </div>

        <!-- å¥‘ç´„ï¼ˆ2é …ç›®ã‚’åŒã˜ä»²é–“ã¨ã—ã¦ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ / å¤§é …ç›®ã«å¿…é ˆï¼‰ -->
        <div class="section">
          <div class="section-title big">å¥‘ç´„é–¢ä¿‚ <span class="req">å¿…é ˆ</span></div>
          <div class="section-sub">ï¼ˆé¡§å®¢åï¼‹ãƒ•ã‚§ãƒ¼ã‚ºï¼‰</div>

          <div class="field">
            <div class="group-card contract-card" role="group" aria-label="å¥‘ç´„é–¢ä¿‚ã®é€²æ—ã¨é€²è¡Œä¸­åˆè¨ˆ">
              <div class="card-item">
                <div class="card-label">å¥‘ç´„é–¢ä¿‚ã®é€²æ—</div>
                <textarea
                  id="contractProgress"
                  name="contractProgress"
                  placeholder="ä¾‹ï¼šã€‡ã€‡æ§˜ï¼šå¯©æŸ»ä¸­"
                  required
                ></textarea>
                <div class="error" data-error-for="contractProgress">å¥‘ç´„é–¢ä¿‚ã®é€²æ—ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>

              <div class="card-item">
                <div class="card-label">é€²è¡Œä¸­åˆè¨ˆ</div>
                <input id="contractTotal" name="contractTotal" type="number" inputmode="numeric" min="0" required />
                <div class="error" data-error-for="contractTotal">é€²è¡Œä¸­åˆè¨ˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>
            </div>
          </div>
        </div>

        <!-- LINEå¯¾å¿œçŠ¶æ³ + æ¸©åº¦æ„Ÿ -->
        <div class="section">
          <div class="section-title big">LINEå¯¾å¿œçŠ¶æ³ <span class="req">å¿…é ˆ</span></div>

          <!-- åŒã˜æ å†…ï¼šç¾åœ¨å¯¾å¿œæ•° / æ–°è¦æ‹…å½“æ•°ï¼ˆæœ¬æ—¥ï¼‹ï¼‰ -->
          <div class="field">
            <div class="group-card cols-2" role="group" aria-label="LINEå¯¾å¿œçŠ¶æ³ KPI">
              <div class="card-item">
                <div class="card-label">ç¾åœ¨å¯¾å¿œæ•°</div>
                <div class="note">â€»æ—¢èª­ç„¡è¦–ã‹ã‚‰48æ™‚é–“çµŒéã—ãŸé¡§å®¢ã‚’é™¤ã</div>
                <input id="lineNow" name="lineNow" type="number" inputmode="numeric" min="0" required />
                <div class="error" data-error-for="lineNow">ç¾åœ¨å¯¾å¿œæ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>

              <div class="card-item">
                <div class="card-label">æ–°è¦æ‹…å½“æ•°ï¼ˆæœ¬æ—¥ï¼‹ï¼‰</div>
                <input id="lineNew" name="lineNew" type="number" inputmode="numeric" min="0" required />
                <div class="error" data-error-for="lineNew">æ–°è¦æ‹…å½“æ•°ï¼ˆæœ¬æ—¥ï¼‹ï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>
            </div>
          </div>

          <!-- åŒã˜æ å†…ï¼šè¿½å®¢æ•° / è¿½å®¢åå¿œæ•° -->
          <div class="field">
            <div class="group-card cols-2" role="group" aria-label="è¿½å®¢ KPI">
              <div class="card-item">
                <div class="card-label">è¿½å®¢æ•°</div>
                <input id="lineFollow" name="lineFollow" type="number" inputmode="numeric" min="0" required />
                <div class="error" data-error-for="lineFollow">è¿½å®¢æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>

              <div class="card-item">
                <div class="card-label">è¿½å®¢åå¿œæ•°</div>
                <div class="note">â€»è¿½å®¢ã‹ã‚‰48æ™‚é–“ä»¥å†…ã«åå¿œã—ãŸé¡§å®¢</div>
                <input id="lineFollowReact" name="lineFollowReact" type="number" inputmode="numeric" min="0" required />
                <div class="error" data-error-for="lineFollowReact">è¿½å®¢åå¿œæ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>
            </div>
          </div>

          <div class="divider"></div>

          <!-- æ¸©åº¦æ„Ÿï¼šå¤§é …ç›®ã¯ä»»æ„ï¼ˆé»’å­—ï¼‰ -->
          <div class="section-title big" style="margin-top:10px;">æ¸©åº¦æ„Ÿ <span class="opt-black">ä»»æ„</span></div>
          <div class="section-sub">ï¼ˆé¡§å®¢åï¼‹çŠ¶æ³ï¼‰</div>

          <div class="field">
            <div class="group-card cols-3 temp-card" role="group" aria-label="æ¸©åº¦æ„Ÿ é«˜ä¸­ä½">
              <div class="card-item">
                <div class="card-label"><span class="temp-chip" data-level="high">é«˜</span></div>
                <textarea id="tempHigh" name="tempHigh" placeholder="ä¾‹ï¼šã€‡ã€‡æ§˜ï¼šå†…è¦‹æ—¥ç¨‹èª¿æ•´ä¸­"></textarea>
              </div>

              <div class="card-item">
                <div class="card-label"><span class="temp-chip" data-level="mid">ä¸­</span></div>
                <textarea id="tempMid" name="tempMid" placeholder="ä¾‹ï¼šâ–³â–³æ§˜ï¼šæ¡ä»¶ã™ã‚Šåˆã‚ã›ä¸­"></textarea>
              </div>

              <div class="card-item">
                <div class="card-label"><span class="temp-chip" data-level="low">ä½</span></div>
                <textarea id="tempLow" name="tempLow" placeholder="ä¾‹ï¼šÃ—Ã—æ§˜ï¼šè¿”ä¿¡å¾…ã¡"></textarea>
              </div>
            </div>
          </div>
        </div>

        <!-- æˆç´„çŠ¶æ³ï¼ˆå¤§é …ç›®ã«å¿…é ˆ / æˆç´„ç‡ã®è¦‹å‡ºã—æ•´ç†ï¼‰ -->
        <div class="section">
          <div class="section-title big">æˆç´„çŠ¶æ³ <span class="req">å¿…é ˆ</span></div>
          <div class="section-sub">â€»èº«å†…ã®ç´¹ä»‹ã‚’é™¤ã</div>

          <div class="field">
            <div class="group-card conv-card" role="group" aria-label="æˆç´„çŠ¶æ³ï¼ˆç´¯è¨ˆï¼‰">
              <div class="card-item">
                <div class="card-label">æˆç´„æ•°ï¼ˆç´¯è¨ˆï¼‰</div>
                <input id="dealTotal" name="dealTotal" type="number" inputmode="numeric" min="0" required />
                <div class="error" data-error-for="dealTotal">æˆç´„æ•°ï¼ˆç´¯è¨ˆï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>

              <div class="card-item">
                <div class="card-label">å¯¾å¿œé¡§å®¢æ•°ï¼ˆç´¯è¨ˆï¼‰</div>
                <div class="note">â€»1åº¦ã§ã‚‚è¿”ä¿¡ãŒã‚ã£ãŸã™ã¹ã¦ã®é¡§å®¢</div>
                <input id="custTotal" name="custTotal" type="number" inputmode="numeric" min="0" required />
                <div class="error" data-error-for="custTotal">å¯¾å¿œé¡§å®¢æ•°ï¼ˆç´¯è¨ˆï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>

              <div class="card-item" style="align-content:start;">
                <div class="kpi" aria-live="polite">
                  <strong>æˆç´„ç‡ï¼ˆç´¯è¨ˆï¼‰</strong>
                  <div class="val" id="conversionRateTotal">â€” %</div>
                </div>
              </div>
            </div>
          </div>

          <div class="field" style="margin-top: 6px;">
            <div class="group-card conv-card" role="group" aria-label="æˆç´„çŠ¶æ³ï¼ˆä»Šæœˆï¼‰">
              <div class="card-item">
                <div class="card-label">æˆç´„æ•°ï¼ˆä»Šæœˆï¼‰</div>
                <input id="dealMonth" name="dealMonth" type="number" inputmode="numeric" min="0" required />
                <div class="error" data-error-for="dealMonth">æˆç´„æ•°ï¼ˆä»Šæœˆï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>

              <div class="card-item">
                <div class="card-label">å¯¾å¿œé¡§å®¢æ•°ï¼ˆä»Šæœˆï¼‰</div>
                <div class="note">â€»1åº¦ã§ã‚‚è¿”ä¿¡ãŒã‚ã£ãŸã™ã¹ã¦ã®é¡§å®¢</div>
                <input id="custMonth" name="custMonth" type="number" inputmode="numeric" min="0" required />
                <div class="error" data-error-for="custMonth">å¯¾å¿œé¡§å®¢æ•°ï¼ˆä»Šæœˆï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
              </div>

              <div class="card-item" style="align-content:start;">
                <div class="kpi" aria-live="polite">
                  <strong>æˆç´„ç‡ï¼ˆä»Šæœˆï¼‰</strong>
                  <div class="val" id="conversionRateMonth">â€” %</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ç¾çŠ¶ã®èª²é¡Œï¼ˆä»»æ„ï¼‰ -->
        <div class="section">
          <div class="section-title">ç¾çŠ¶ã®èª²é¡Œ <span class="opt">ä»»æ„</span></div>
          <div class="field">
            <textarea
              id="issues"
              name="issues"
              placeholder="å…·ä½“çš„ã«è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚"
            ></textarea>
            <!-- ä»»æ„åŒ–ã®ãŸã‚ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã¯ä¸è¦ï¼ˆæ®‹ã—ã¦ã‚‚OKã ãŒä½¿ã‚ãªã„ï¼‰ -->
          </div>
        </div>

        <!-- æ”¹å–„æ¡ˆï¼ˆä»»æ„ï¼‰ -->
        <div class="section">
          <div class="section-title">æ”¹å–„æ¡ˆ <span class="opt">ä»»æ„</span></div>
          <div class="field">
            <textarea
              id="improvements"
              name="improvements"
              placeholder="å…·ä½“çš„ã«è¨˜è¿°ã—ã¦ãã ã•ã„ã€‚"
            ></textarea>
            <!-- ä»»æ„åŒ–ã®ãŸã‚ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºã¯ä¸è¦ï¼ˆæ®‹ã—ã¦ã‚‚OKã ãŒä½¿ã‚ãªã„ï¼‰ -->
          </div>
        </div>

        <!-- æ˜æ—¥ã®äºˆå®š -->
        <div class="section">
          <div class="section-title">æ˜æ—¥ã®äºˆå®š <span class="req">å¿…é ˆ</span></div>
          <div class="field">
            <textarea id="tomorrowPlan" name="tomorrowPlan" required></textarea>
            <div class="error" data-error-for="tomorrowPlan">æ˜æ—¥ã®äºˆå®šã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</div>
          </div>

          <div class="divider"></div>

          <div class="field">
            <div class="section-title">ãã®ä»–ãƒ¡ãƒ¢ <span class="opt">ä»»æ„</span></div>
            <textarea id="memo" name="memo" placeholder="æ°—ã¥ã / å…±æœ‰ã—ãŸã„ã“ã¨ãªã©"></textarea>
          </div>
        </div>

        <div class="actions">
          <button class="btn btn-primary" type="submit">å›ç­”ã™ã‚‹</button>
          <button class="btn btn-ghost" type="reset">å…¥åŠ›ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
          <div id="formMsg" class="hint"></div>
        </div>
      </form>
    </main>

    <footer></footer>
  </div>

  <script>
    (function(){
      // EmailJS init
      const EMAILJS_SERVICE_ID = "service_sgac4or";
      const EMAILJS_TEMPLATE_ID = "template_hmmrh9t";
      const EMAILJS_PUBLIC_KEY  = "QedlQxUXH2yDJJvjU";

      try{
        if (window.emailjs) {
          emailjs.init({ publicKey: EMAILJS_PUBLIC_KEY });
        }
      }catch(e){
        try{ if (window.emailjs) emailjs.init(EMAILJS_PUBLIC_KEY); }catch(_e){}
      }

      const form = document.getElementById("dailyReportForm");
      const msg = document.getElementById("formMsg");
      const hero = document.getElementById("heroSection");

      const thankYouStage = document.getElementById("thankYouStage");
      const thankYouSection = document.getElementById("thankYouSection");

      const headerForm = document.getElementById("headerForm");
      const headerThanks = document.getElementById("headerThanks");

      const showError = (name, on) => {
        const el = document.querySelector(`[data-error-for="${name}"]`);
        if(!el) return;
        el.style.display = on ? "block" : "none";
      };

      const toNumOrNaN = (v) => {
        const s = String(v ?? "").trim();
        if (s === "") return NaN;
        const n = Number(s);
        return Number.isFinite(n) ? n : NaN;
      };

      const nonEmpty = (v) => String(v ?? "").trim().length > 0;

      const validators = {
        date: () => !!form.date.value,
        name: () => nonEmpty(form.name.value),
        summary: () => nonEmpty(form.summary.value),
        contractProgress: () => nonEmpty(form.contractProgress.value),
        contractTotal: () => {
          const n = toNumOrNaN(form.contractTotal.value);
          return !Number.isNaN(n) && n >= 0;
        },

        lineNow: () => {
          const n = toNumOrNaN(form.lineNow.value);
          return !Number.isNaN(n) && n >= 0;
        },
        lineNew: () => {
          const n = toNumOrNaN(form.lineNew.value);
          return !Number.isNaN(n) && n >= 0;
        },
        lineFollow: () => {
          const n = toNumOrNaN(form.lineFollow.value);
          return !Number.isNaN(n) && n >= 0;
        },
        lineFollowReact: () => {
          const n = toNumOrNaN(form.lineFollowReact.value);
          return !Number.isNaN(n) && n >= 0;
        },

        dealTotal: () => {
          const n = toNumOrNaN(form.dealTotal.value);
          return !Number.isNaN(n) && n >= 0;
        },
        custTotal: () => {
          const n = toNumOrNaN(form.custTotal.value);
          return !Number.isNaN(n) && n >= 0;
        },
        dealMonth: () => {
          const n = toNumOrNaN(form.dealMonth.value);
          return !Number.isNaN(n) && n >= 0;
        },
        custMonth: () => {
          const n = toNumOrNaN(form.custMonth.value);
          return !Number.isNaN(n) && n >= 0;
        },

        // issues / improvements ã¯ä»»æ„åŒ–ã—ãŸã®ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å¯¾è±¡å¤–
        tomorrowPlan: () => nonEmpty(form.tomorrowPlan.value)
      };

      const REQUIRED_KEYS = [
        "date","name",
        "summary",
        "contractProgress","contractTotal",
        "lineNow","lineNew","lineFollow","lineFollowReact",
        "dealTotal","custTotal","dealMonth","custMonth",
        "tomorrowPlan"
      ];

      const validateAll = () => {
        let ok = true;
        REQUIRED_KEYS.forEach(k => showError(k, false));

        REQUIRED_KEYS.forEach(k => {
          const pass = validators[k]();
          if (!pass) { showError(k, true); ok = false; }
        });
        return ok;
      };

      const pad2 = (n) => String(n).padStart(2, "0");
      const formatDateTime = () => {
        const d = new Date();
        const y = d.getFullYear();
        const m = pad2(d.getMonth() + 1);
        const day = pad2(d.getDate());
        const h = pad2(d.getHours());
        const min = pad2(d.getMinutes());
        const s = pad2(d.getSeconds());
        return `${y}-${m}-${day} ${h}:${min}:${s}`;
      };

      const rateText = (num, den) => {
        if (!(den > 0)) return "â€” %";
        const r = (num / den) * 100;
        const rounded = Math.round(r * 10) / 10;
        return `${rounded.toFixed(1)} %`;
      };

      const updateRates = () => {
        const dealTotal = Number.isFinite(Number(form.dealTotal.value)) ? Number(form.dealTotal.value) : 0;
        const custTotal = Number.isFinite(Number(form.custTotal.value)) ? Number(form.custTotal.value) : 0;
        const dealMonth = Number.isFinite(Number(form.dealMonth.value)) ? Number(form.dealMonth.value) : 0;
        const custMonth = Number.isFinite(Number(form.custMonth.value)) ? Number(form.custMonth.value) : 0;

        const elTotal = document.getElementById("conversionRateTotal");
        const elMonth = document.getElementById("conversionRateMonth");
        if (elTotal) elTotal.textContent = rateText(dealTotal, custTotal);
        if (elMonth) elMonth.textContent = rateText(dealMonth, custMonth);
      };

      ["dealTotal","custTotal","dealMonth","custMonth"].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.addEventListener("input", updateRates);
      });
      updateRates();

      const buildPayload = () => {
        return {
          submittedAt: formatDateTime(),
          date: form.date.value,
          name: form.name.value.trim(),

          summary: form.summary.value,
          contractProgress: form.contractProgress.value,
          contractTotal: form.contractTotal.value,

          lineNow: form.lineNow.value,
          lineNew: form.lineNew.value,
          lineFollow: form.lineFollow.value,
          lineFollowReact: form.lineFollowReact.value,

          tempHigh: form.tempHigh.value,
          tempMid: form.tempMid.value,
          tempLow: form.tempLow.value,

          dealTotal: form.dealTotal.value,
          custTotal: form.custTotal.value,
          conversionRateTotal: document.getElementById("conversionRateTotal")?.textContent ?? "",

          dealMonth: form.dealMonth.value,
          custMonth: form.custMonth.value,
          conversionRateMonth: document.getElementById("conversionRateMonth")?.textContent ?? "",

          // ä»»æ„ã ã‘ã©é€ã‚‹ï¼ˆç©ºãªã‚‰ç©ºã®ã¾ã¾ï¼‰
          issues: form.issues.value,
          improvements: form.improvements.value,

          tomorrowPlan: form.tomorrowPlan.value,
          memo: form.memo.value
        };
      };

      const showThankYouView = () => {
        try{
          if (document.activeElement && typeof document.activeElement.blur === "function") {
            document.activeElement.blur();
          }
        }catch(e){}

        if (hero) hero.style.display = "none";
        form.style.display = "none";

        if (thankYouStage) thankYouStage.style.display = "flex";

        if (thankYouSection) {
          thankYouSection.classList.remove("fade-in");
          void thankYouSection.offsetWidth;
          thankYouSection.classList.add("fade-in");
        }

        if (headerForm) headerForm.style.display = "none";
        if (headerThanks) headerThanks.style.display = "flex";

        window.scrollTo({ top: 0, behavior: "auto" });
      };

      const wireLiveClear = () => {
        REQUIRED_KEYS.forEach((k) => {
          const node = form[k];
          if (!node) return;
          const evt = (node.tagName === "SELECT") ? "change" : "input";
          node.addEventListener(evt, () => {
            if (validators[k]()) showError(k, false);
          });
          node.addEventListener("blur", () => {
            if (validators[k]()) showError(k, false);
          });
        });
      };
      wireLiveClear();

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        msg.textContent = "";

        const ok = validateAll();
        if (!ok) return;

        const submitBtn = form.querySelector('button[type="submit"]');
        if (submitBtn) {
          submitBtn.disabled = true;
          submitBtn.style.filter = "grayscale(0.15)";
        }

        msg.textContent = "é€ä¿¡ä¸­â€¦";

        try{
          const payload = buildPayload();
          console.log("DailyReport payload:", payload);

          if (!window.emailjs) {
            throw new Error("EmailJSãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚");
          }

          await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, payload);

          msg.textContent = "å®Œäº†ã—ã¾ã—ãŸã€‚";
          showThankYouView();

        }catch(err){
          console.error(err);
          msg.textContent = "é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚";
          alert("é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚");
        }finally{
          if (submitBtn) {
            submitBtn.disabled = false;
            submitBtn.style.filter = "";
          }
        }
      });

      form.addEventListener("reset", () => {
        REQUIRED_KEYS.forEach(k => showError(k, false));
        msg.textContent = "";
        setTimeout(updateRates, 0);
      });

      // åˆå›ï¼šæ—¥ä»˜ã‚’ä»Šæ—¥ã«ã‚»ãƒƒãƒˆï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè§¦ã£ã¦ãªã‘ã‚Œã°ï¼‰
      try{
        if (!form.date.value) {
          const d = new Date();
          const yyyy = d.getFullYear();
          const mm = String(d.getMonth()+1).padStart(2,"0");
          const dd = String(d.getDate()).padStart(2,"0");
          form.date.value = `${yyyy}-${mm}-${dd}`;
        }
      }catch(e){}
    })();
  </script>
</body>
</html>
